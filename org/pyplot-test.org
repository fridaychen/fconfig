:options:
#+startup: inlineimages
:end:

#+call: plot(output="test-plot-sin-cos.png", title="Single Plot",
xrange="[0, m.pi *2]",
f1="lambda x: m.cos(x)", l1="cos()",
f2="lambda x: m.sin(x) + 1",l2="sin()+1")

#+RESULTS:
[[file:]]

#+tblname: city-pop
| city     | 2020 population |
|----------+-----------------|
| Beijing  |             100 |
| Shenyang |             200 |
| Shanghai |              39 |

#+call: plotbar(output="test-city-pop-bar.png",title="City population",datatable=city-pop,height=60,width=100,rotation=45)

#+RESULTS:
[[file:test-city-pop-bar.png]]

#+call: plotpie(datatable=city-pop, output="test-city-pop-pie.png",title="City population")

#+RESULTS:
[[file:test-city-pop-pie.png]]

#+HEADER: :var font=(symbol-value '*fc-plot-font*) :var bg=(symbol-value '*fc-plot-bg*)
#+BEGIN_SRC python :var datatable=city-pop :colnames no :results file
  import fmath.plot as fp
  import numpy as np

  x, y = zip(*datatable)

  f = fp.start_plot((1, 2), height=60, width=200, font=font, bg=bg, subtitles=["Bar chart", "Pie chart"])

  f.select((0, 0))
  f.label(x[0], y[0])
  f.grid(axis="y", caxis=False)
  f.bar(x[1:], y[1:])

  f.select((0, 1))
  f.pie(x[1:], y[1:])

  f.save("test-subplot.png")

  return "test-subplot.png"
#+END_SRC

#+RESULTS:
[[file:test-subplot.png]]

#+call: plothist(datafile="test-data1.txt",output="test-hist.png",title="New World!")

#+RESULTS:
[[file:test-hist.png]]

#+HEADER: :var font=(symbol-value '*fc-plot-font*) :var bg=(symbol-value '*fc-plot-bg*)
#+BEGIN_SRC python :results file
  import fmath.plot as fp
  import numpy as np

  f = fp.start_plot((1, 2), height=60, width=200, font=font, bg=bg)

  xa = np.arange(0, 6.28, 0.1)

  f.select((0, 0))
  f.grid()
  f.plotf(xa, lambda x: m.sin(x), label="sin我们hell")
  f.plotf(xa, lambda x: m.cos(x), label="cos")

  data = fp.loadtxt("test-data2.txt")

  f.select((0, 1))
  f.grid()
  f.plot(data[:, 0], data[:, 1], label="data2")

  f.save("test-subplot.png")

  return "test-subplot.png"
#+END_SRC

#+RESULTS:
[[file:test-subplot.png]]

#+tblname: city-pops
| city     | 2020 | 2021 | 2022 |
|----------+------+------+------|
| Beijing  |  100 |  102 |  120 |
| Shenyang |  200 |  212 |  150 |
| Shanghai |   39 |   50 |   41 |

#+call: plotmbar(datatable=city-pops, output="test-city-pop-mbar.png",title="人口变化趋势",xlabel="City", ylabel="Population",rotation=-45)

#+RESULTS:
[[file:test-city-pop-mbar.png]]
